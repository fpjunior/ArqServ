<div class="min-h-screen bg-gradient-to-br from-slate-50 to-gray-100">
  <!-- Header -->
  <div class="mb-8 pt-6 px-6">
    <div class="flex items-center justify-between">
      <div class="flex items-center gap-4">
        <button 
          (click)="goBack()"
          class="p-3 hover:bg-white/80 rounded-xl transition-colors shadow-sm border border-gray-200">
          <span class="text-xl">‚Üê</span>
        </button>
        
        <div class="flex items-center gap-4">
          <div class="w-16 h-16 bg-gradient-to-r from-blue-600 to-blue-700 rounded-2xl flex items-center justify-center shadow-lg">
            <span class="text-3xl filter drop-shadow-lg">üë§</span>
          </div>
          
          <div>
            <h1 class="text-3xl font-bold text-gray-900">Cadastrar Usu√°rio</h1>
            <p class="text-gray-600 mt-1">Adicione um novo usu√°rio ao sistema</p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Form Content -->
  <div class="max-w-2xl mx-auto px-6 pb-8">
    <div class="bg-white rounded-2xl shadow-lg border border-gray-200 overflow-hidden">
      <form [formGroup]="userForm" (ngSubmit)="onSubmit()">
        <div class="p-8">
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            
            <!-- Nome -->
            <div class="md:col-span-2">
              <label class="block text-sm font-semibold text-gray-700 mb-2">
                Nome Completo *
              </label>
              <input
                type="text"
                formControlName="name"
                placeholder="Digite o nome completo"
                class="w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors"
                [class.border-red-500]="isFieldInvalid('name')"
                [class.border-gray-300]="!isFieldInvalid('name')">
              <div class="text-red-500 text-sm mt-1" *ngIf="isFieldInvalid('name')">
                {{ getFieldError('name') }}
              </div>
            </div>

            <!-- Email -->
            <div class="md:col-span-2">
              <label class="block text-sm font-semibold text-gray-700 mb-2">
                Email *
              </label>
              <input
                type="email"
                formControlName="email"
                placeholder="usuario@exemplo.com"
                class="w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors"
                [class.border-red-500]="isFieldInvalid('email')"
                [class.border-gray-300]="!isFieldInvalid('email')">
              <div class="text-red-500 text-sm mt-1" *ngIf="isFieldInvalid('email')">
                {{ getFieldError('email') }}
              </div>
            </div>

            <!-- Tipo de Usu√°rio -->
            <div class="md:col-span-2">
              <label class="block text-sm font-semibold text-gray-700 mb-2">
                Tipo de Usu√°rio *
              </label>
              <div class="grid grid-cols-2 gap-4">
                <label class="flex items-center p-4 border-2 rounded-xl cursor-pointer transition-colors hover:bg-gray-50"
                       [class.border-blue-500]="userForm.get('user_type')?.value === 'prefeitura'"
                       [class.bg-blue-50]="userForm.get('user_type')?.value === 'prefeitura'"
                       [class.border-gray-200]="userForm.get('user_type')?.value !== 'prefeitura'">
                  <input
                    type="radio"
                    formControlName="user_type"
                    value="prefeitura"
                    class="sr-only">
                  <div class="flex items-center">
                    <div class="w-4 h-4 border-2 rounded-full mr-3 flex items-center justify-center"
                         [class.border-blue-500]="userForm.get('user_type')?.value === 'prefeitura'"
                         [class.border-gray-300]="userForm.get('user_type')?.value !== 'prefeitura'">
                      <div class="w-2 h-2 bg-blue-500 rounded-full"
                           *ngIf="userForm.get('user_type')?.value === 'prefeitura'"></div>
                    </div>
                    <div>
                      <div class="font-medium text-gray-900">üèõÔ∏è Prefeitura</div>
                      <div class="text-sm text-gray-500">Usu√°rio municipal</div>
                    </div>
                  </div>
                </label>

                <label class="flex items-center p-4 border-2 rounded-xl cursor-pointer transition-colors hover:bg-gray-50"
                       [class.border-blue-500]="userForm.get('user_type')?.value === 'admin'"
                       [class.bg-blue-50]="userForm.get('user_type')?.value === 'admin'"
                       [class.border-gray-200]="userForm.get('user_type')?.value !== 'admin'">
                  <input
                    type="radio"
                    formControlName="user_type"
                    value="admin"
                    class="sr-only">
                  <div class="flex items-center">
                    <div class="w-4 h-4 border-2 rounded-full mr-3 flex items-center justify-center"
                         [class.border-blue-500]="userForm.get('user_type')?.value === 'admin'"
                         [class.border-gray-300]="userForm.get('user_type')?.value !== 'admin'">
                      <div class="w-2 h-2 bg-blue-500 rounded-full"
                           *ngIf="userForm.get('user_type')?.value === 'admin'"></div>
                    </div>
                    <div>
                      <div class="font-medium text-gray-900">‚öôÔ∏è Admin</div>
                      <div class="text-sm text-gray-500">Administrador</div>
                    </div>
                  </div>
                </label>
              </div>
            </div>

            <!-- N√≠vel de Acesso -->
            <div class="md:col-span-2">
              <label class="block text-sm font-semibold text-gray-700 mb-2">
                N√≠vel de Acesso *
              </label>
              <select
                formControlName="role"
                class="w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors bg-white"
                [class.border-red-500]="isFieldInvalid('role')"
                [class.border-gray-300]="!isFieldInvalid('role')">
                <option value="user">üë§ Usu√°rio - Acesso limitado</option>
                <option value="admin">‚öôÔ∏è Admin - Acesso completo</option>
              </select>
              <div class="text-red-500 text-sm mt-1" *ngIf="isFieldInvalid('role')">
                {{ getFieldError('role') }}
              </div>
            </div>

            <!-- Munic√≠pio (apenas para prefeituras) -->
            <div class="md:col-span-2" *ngIf="userForm.get('user_type')?.value === 'prefeitura'">
              <label class="block text-sm font-semibold text-gray-700 mb-2">
                Munic√≠pio *
              </label>
              <select
                formControlName="municipality"
                class="w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors bg-white"
                [class.border-red-500]="isFieldInvalid('municipality')"
                [class.border-gray-300]="!isFieldInvalid('municipality')">
                <option value="">Selecione o munic√≠pio</option>
                <option *ngFor="let municipality of municipalities" [value]="municipality.name">
                  {{ municipality.name }} - {{ municipality.state }}
                </option>
              </select>
              <div class="text-red-500 text-sm mt-1" *ngIf="isFieldInvalid('municipality')">
                {{ getFieldError('municipality') }}
              </div>
            </div>

            <!-- Senha -->
            <div>
              <label class="block text-sm font-semibold text-gray-700 mb-2">
                Senha *
              </label>
              <div class="relative">
                <input
                  [type]="showPassword ? 'text' : 'password'"
                  formControlName="password"
                  placeholder="Digite a senha"
                  class="w-full px-4 py-3 pr-12 border rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors"
                  [class.border-red-500]="isFieldInvalid('password')"
                  [class.border-gray-300]="!isFieldInvalid('password')">
                <button
                  type="button"
                  (click)="togglePasswordVisibility()"
                  class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700">
                  <span *ngIf="!showPassword">üëÅÔ∏è</span>
                  <span *ngIf="showPassword">üôà</span>
                </button>
              </div>
              <div class="text-red-500 text-sm mt-1" *ngIf="isFieldInvalid('password')">
                {{ getFieldError('password') }}
              </div>
            </div>

            <!-- Confirmar Senha -->
            <div>
              <label class="block text-sm font-semibold text-gray-700 mb-2">
                Confirmar Senha *
              </label>
              <div class="relative">
                <input
                  [type]="showConfirmPassword ? 'text' : 'password'"
                  formControlName="confirmPassword"
                  placeholder="Confirme a senha"
                  class="w-full px-4 py-3 pr-12 border rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors"
                  [class.border-red-500]="isFieldInvalid('confirmPassword')"
                  [class.border-gray-300]="!isFieldInvalid('confirmPassword')">
                <button
                  type="button"
                  (click)="toggleConfirmPasswordVisibility()"
                  class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700">
                  <span *ngIf="!showConfirmPassword">üëÅÔ∏è</span>
                  <span *ngIf="showConfirmPassword">üôà</span>
                </button>
              </div>
              <div class="text-red-500 text-sm mt-1" *ngIf="isFieldInvalid('confirmPassword')">
                {{ getFieldError('confirmPassword') }}
              </div>
            </div>

          </div>
        </div>

        <!-- Footer -->
        <div class="bg-gray-50 px-8 py-6 flex items-center justify-between border-t border-gray-200">
          <div class="text-sm text-gray-500">
            * Campos obrigat√≥rios
          </div>
          
          <div class="flex gap-3">
            <button
              type="button"
              (click)="goBack()"
              class="px-6 py-3 border border-gray-300 text-gray-700 rounded-xl hover:bg-gray-50 transition-colors">
              Cancelar
            </button>
            
            <button
              type="submit"
              [disabled]="isLoading || !userForm.valid"
              class="px-6 py-3 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-xl hover:from-blue-700 hover:to-blue-800 transition-all shadow-lg disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2">
              <span *ngIf="isLoading" class="w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"></span>
              <span>{{ isLoading ? 'Cadastrando...' : 'Cadastrar Usu√°rio' }}</span>
            </button>
          </div>
        </div>
      </form>
    </div>
  </div>
</div>